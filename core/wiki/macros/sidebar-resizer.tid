title: $:/core/macros/sidebar-resizer
tags: $:/tags/Global

\procedure sidebar-resizer-pointerdown-actions()
<%if [[$:/state/sidebar/resizing]is[missing]then<event-mousebutton>match[left]] %>
	<$let leftOffset={{{ [<event-fromviewport-posx>subtract<event-fromcatcher-posx>] }}} viewportWidth={{{ [<leftOffset>add<tv-widgetnode-width>] }}} dragDiff=<<event-fromselected-posx>> leftOffsetPercentage={{{ [<leftOffset>divide<viewportWidth>] }}} dragDiffPercentage={{{ [<dragDiff>divide<viewportWidth>] }}} dragWidthPercentage={{{ [<tv-selectednode-width>divide<viewportWidth>] }}} sidebarOffsetPercentage={{{ [[22]divide<viewportWidth>] }}} storyRiverPercentage={{{ [<event-fromcatcher-posx>divide<viewportWidth>subtract<dragDiffPercentage>] }}} sidebarPercentage={{{ [[1]subtract<storyRiverPercentage>subtract<sidebarOffsetPercentage>subtract<leftOffsetPercentage>] }}} widgetNodeWidthPercentage={{{ [<tv-widgetnode-width>divide<viewportWidth>] }}}>
		<$action-setfield $tiddler="$:/state/sidebar/dimensions"
			left-offset=<<leftOffset>>
			left-offset-percentage=<<leftOffsetPercentage>>
			widget-node-width-percentage=<<widgetNodeWidthPercentage>>
			widget-node-width=<<tv-widgetnode-width>>
			drag-width=<<tv-selectednode-width>>
			drag-diff=<<dragDiff>>
			drag-diff-percentage=<<dragDiffPercentage>>
			drag-width-percentage=<<dragWidthPercentage>>
			sidebar-offset-percentage=<<sidebarOffsetPercentage>>
			story-river-percentage=<<storyRiverPercentage>>
			sidebar-percentage=<<sidebarPercentage>>/>
		<$action-setfield $tiddler="$:/state/sidebar/resizing" text="yes"/>
	</$let>
<% endif %>
\end
\procedure sidebar-resizer-pointerup-actions()
<%if [[$:/state/sidebar/resizing]!is[missing]] %>
	<$action-deletetiddler $tiddler="$:/state/sidebar/resizing"/>
<% endif %>
\end
\procedure sidebar-resizer-pointermove-actions()
<%if [[$:/state/sidebar/resizing]!is[missing]] %>
	<$let leftOffset={{$:/state/sidebar/dimensions!!left-offset}} viewportWidth={{{ [<leftOffset>add<tv-widgetnode-width>] }}} leftOffsetPercentage={{{ [<leftOffset>divide<viewportWidth>] }}} storyRiverPercentage={{{ [<event-fromcatcher-posx>divide<viewportWidth>subtract{$:/state/sidebar/dimensions!!drag-diff-percentage}] }}} sidebarPercentage={{{ [[1]subtract<storyRiverPercentage>subtract{$:/state/sidebar/dimensions!!sidebar-offset-percentage}subtract<leftOffsetPercentage>] }}}>
		<$action-setfield $tiddler="$:/state/sidebar/dimensions"
			story-river-percentage=<<storyRiverPercentage>>
			sidebar-percentage=<<sidebarPercentage>>/>
	</$let>
<% endif %>
\end